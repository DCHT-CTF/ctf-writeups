import{r as vt,g as jt,u as yt,i as p,j as e,a as s,B as i,C as F,P as I,T as a,b as A,I as N,F as xe,A as qe,c as L,S as Ct,d as T,e as St,G as S,f as Ae,h as Le,k as He,L as Q,l as G,m as ie,n as V,o as ne,D as wt,p as _t,q as kt,s as J,M as Oe,t as X,R as Mt}from"./vendor-C8vfU4QZ.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))x(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&x(h)}).observe(document,{childList:!0,subtree:!0});function m(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function x(n){if(n.ep)return;n.ep=!0;const c=m(n);fetch(n.href,c)}})();var de={},We=vt;de.createRoot=We.createRoot,de.hydrateRoot=We.hydrateRoot;var he={},le={};const $t=jt(yt);var Te;function f(){return Te||(Te=1,function(g){"use client";Object.defineProperty(g,"__esModule",{value:!0}),Object.defineProperty(g,"default",{enumerable:!0,get:function(){return d.createSvgIcon}});var d=$t}(le)),le}var Et=p;Object.defineProperty(he,"__esModule",{value:!0});var Z=he.default=void 0,Dt=Et(f()),It=e;Z=he.default=(0,Dt.default)((0,It.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star");var pe={},Rt=p;Object.defineProperty(pe,"__esModule",{value:!0});var Ne=pe.default=void 0,Bt=Rt(f()),Pt=e;Ne=pe.default=(0,Bt.default)((0,Pt.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person");var fe={},zt=p;Object.defineProperty(fe,"__esModule",{value:!0});var Ye=fe.default=void 0,Ft=zt(f()),At=e;Ye=fe.default=(0,Ft.default)((0,At.jsx)("path",{d:"M9 1h6v2H9zm10.03 6.39 1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61M13 14h-2V8h2z"}),"Timer");var ge={},Lt=p;Object.defineProperty(ge,"__esModule",{value:!0});var Ge=ge.default=void 0,Ht=Lt(f()),Ot=e;Ge=ge.default=(0,Ht.default)((0,Ot.jsx)("path",{d:"m19 9 1.25-2.75L23 5l-2.75-1.25L19 1l-1.25 2.75L15 5l2.75 1.25zm-7.5.5L9 4 6.5 9.5 1 12l5.5 2.5L9 20l2.5-5.5L17 12zM19 15l-1.25 2.75L15 19l2.75 1.25L19 23l1.25-2.75L23 19l-2.75-1.25z"}),"AutoAwesome");var me={},Wt=p;Object.defineProperty(me,"__esModule",{value:!0});var ee=me.default=void 0,Tt=Wt(f()),Y=e;ee=me.default=(0,Tt.default)([(0,Y.jsx)("circle",{cx:"4.5",cy:"9.5",r:"2.5"},"0"),(0,Y.jsx)("circle",{cx:"9",cy:"5.5",r:"2.5"},"1"),(0,Y.jsx)("circle",{cx:"15",cy:"5.5",r:"2.5"},"2"),(0,Y.jsx)("circle",{cx:"19.5",cy:"9.5",r:"2.5"},"3"),(0,Y.jsx)("path",{d:"M17.34 14.86c-.87-1.02-1.6-1.89-2.48-2.91-.46-.54-1.05-1.08-1.75-1.32-.11-.04-.22-.07-.33-.09-.25-.04-.52-.04-.78-.04s-.53 0-.79.05c-.11.02-.22.05-.33.09-.7.24-1.28.78-1.75 1.32-.87 1.02-1.6 1.89-2.48 2.91-1.31 1.31-2.92 2.76-2.62 4.79.29 1.02 1.02 2.03 2.33 2.32.73.15 3.06-.44 5.54-.44h.18c2.48 0 4.81.58 5.54.44 1.31-.29 2.04-1.31 2.33-2.32.31-2.04-1.3-3.49-2.61-4.8"},"4")],"Pets");var be={},Vt=p;Object.defineProperty(be,"__esModule",{value:!0});var ve=be.default=void 0,qt=Vt(f()),Nt=e;ve=be.default=(0,qt.default)((0,Nt.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h5v-2H4v-6h18V6c0-1.11-.89-2-2-2m0 4H4V6h16zm-5.07 11.17-2.83-2.83-1.41 1.41L14.93 22 22 14.93l-1.41-1.41z"}),"CreditScore");var je={},Yt=p;Object.defineProperty(je,"__esModule",{value:!0});var Ke=je.default=void 0,Gt=Yt(f()),Kt=e;Ke=je.default=(0,Gt.default)((0,Kt.jsx)("path",{d:"m21.41 11.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42M5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7"}),"LocalOffer");var ye={},Ut=p;Object.defineProperty(ye,"__esModule",{value:!0});var Ce=ye.default=void 0,Jt=Ut(f()),Xt=e;Ce=ye.default=(0,Jt.default)((0,Xt.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2m3.3 14.71L11 12.41V7h2v4.59l3.71 3.71z"}),"AccessTimeFilled");var Se={},Qt=p;Object.defineProperty(Se,"__esModule",{value:!0});var Ue=Se.default=void 0,Zt=Qt(f()),er=e;Ue=Se.default=(0,Zt.default)((0,er.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School");var we={},tr=p;Object.defineProperty(we,"__esModule",{value:!0});var Je=we.default=void 0,rr=tr(f()),or=e;Je=we.default=(0,rr.default)((0,or.jsx)("path",{d:"M12 6c1.11 0 2-.9 2-2 0-.38-.1-.73-.29-1.03L12 0l-1.71 2.97c-.19.3-.29.65-.29 1.03 0 1.1.9 2 2 2m4.6 9.99-1.07-1.07-1.08 1.07c-1.3 1.3-3.58 1.31-4.89 0l-1.07-1.07-1.09 1.07C6.75 16.64 5.88 17 4.96 17c-.73 0-1.4-.23-1.96-.61V21c0 .55.45 1 1 1h16c.55 0 1-.45 1-1v-4.61c-.56.38-1.23.61-1.96.61-.92 0-1.79-.36-2.44-1.01M18 9h-5V7h-2v2H6c-1.66 0-3 1.34-3 3v1.54c0 1.08.88 1.96 1.96 1.96.52 0 1.02-.2 1.38-.57l2.14-2.13 2.13 2.13c.74.74 2.03.74 2.77 0l2.14-2.13 2.13 2.13c.37.37.86.57 1.38.57 1.08 0 1.96-.88 1.96-1.96V12C21 10.34 19.66 9 18 9"}),"Cake");var _e={},ar=p;Object.defineProperty(_e,"__esModule",{value:!0});var Xe=_e.default=void 0,sr=ar(f()),ir=e;Xe=_e.default=(0,sr.default)((0,ir.jsx)("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2M5 8V7h2v3.82C5.84 10.4 5 9.3 5 8m14 0c0 1.3-.84 2.4-2 2.82V7h2z"}),"EmojiEvents");var ke={},nr=p;Object.defineProperty(ke,"__esModule",{value:!0});var Qe=ke.default=void 0,lr=nr(f()),cr=e;Qe=ke.default=(0,lr.default)((0,cr.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2m0 14H4v-6h16zm0-10H4V6h16z"}),"CreditCard");var Me={},dr=p;Object.defineProperty(Me,"__esModule",{value:!0});var ue=Me.default=void 0,ur=dr(f()),xr=e;ue=Me.default=(0,ur.default)((0,xr.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1z"}),"Lock");var $e={},hr=p;Object.defineProperty($e,"__esModule",{value:!0});var Ze=$e.default=void 0,pr=hr(f()),fr=e;Ze=$e.default=(0,pr.default)((0,fr.jsx)("path",{d:"M17 12h-5v5h5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1zm3 18H5V8h14z"}),"Event");var Ee={},gr=p;Object.defineProperty(Ee,"__esModule",{value:!0});var et=Ee.default=void 0,mr=gr(f()),br=e;et=Ee.default=(0,mr.default)((0,br.jsx)("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"}),"Email");function vr({onSuccess:g,onCancel:d,selectedPackage:m}){const[x,n]=s.useState({number:"",expiry:"",cvv:"",name:"",email:""}),[c,h]=s.useState(""),[H,R]=s.useState(!1),[$,w]=s.useState(!1),v=b=>O=>{var W,E;let _=O.target.value;b==="number"&&(_=((W=_.replace(/\s/g,"").match(/.{1,4}/g))==null?void 0:W.join(" "))||"",w(!1)),b==="expiry"&&(_=((E=_.replace(/\D/g,"").match(/.{1,2}/g))==null?void 0:E.join("/"))||""),n(C=>({...C,[b]:_})),h("")},j=async b=>{if(b.preventDefault(),R(!0),h(""),!x.email||!x.number||!x.expiry||!x.cvv||!x.name){h("Пожалуйста, заполните все поля"),R(!1);return}if(!x.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)){h("Пожалуйста, введите корректный email адрес"),R(!1);return}w(!0),R(!1),h("К оплате принимаются только карты Капибанка")};return e.jsx(i,{sx:{minHeight:"100vh",bgcolor:"#1a1a1a",py:4,px:2},children:e.jsx(F,{maxWidth:"sm",children:e.jsxs(I,{elevation:3,sx:{p:4,bgcolor:"rgba(42, 8, 69, 0.95)",backdropFilter:"blur(10px)",borderRadius:4,border:"1px solid rgba(78, 205, 196, 0.1)"},children:[e.jsxs(i,{sx:{mb:4,textAlign:"center"},children:[e.jsx(a,{variant:"h4",gutterBottom:!0,sx:{color:"#4ECDC4",textShadow:"0 0 10px rgba(78, 205, 196, 0.3)"},children:"Оплата"}),m&&e.jsxs(a,{variant:"h6",sx:{color:"rgba(255,255,255,0.9)"},children:[m.amount," ",m.amount>=5?"Астролапок":"Астролапки"," за ",m.price]})]}),e.jsxs("form",{onSubmit:j,children:[e.jsx(A,{fullWidth:!0,label:"Email",value:x.email,onChange:v("email"),margin:"normal",type:"email",InputProps:{startAdornment:e.jsx(N,{position:"start",children:e.jsx(et,{sx:{color:"#4ECDC4"}})})},placeholder:"example@mail.com",sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"rgba(78, 205, 196, 0.3)"},"&:hover fieldset":{borderColor:"rgba(78, 205, 196, 0.5)"},"&.Mui-focused fieldset":{borderColor:"#4ECDC4"}},"& .MuiInputLabel-root":{color:"rgba(255, 255, 255, 0.7)"},"& .MuiOutlinedInput-input":{color:"rgba(255, 255, 255, 0.9)"}}}),e.jsx(A,{fullWidth:!0,label:"Номер карты",value:x.number,onChange:v("number"),margin:"normal",InputProps:{startAdornment:e.jsx(N,{position:"start",children:e.jsx(Qe,{sx:{color:"#4ECDC4"}})})},placeholder:"Введите номер карты",inputProps:{maxLength:19},sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"rgba(78, 205, 196, 0.3)"},"&:hover fieldset":{borderColor:"rgba(78, 205, 196, 0.5)"},"&.Mui-focused fieldset":{borderColor:"#4ECDC4"}},"& .MuiInputLabel-root":{color:"rgba(255, 255, 255, 0.7)"},"& .MuiOutlinedInput-input":{color:"rgba(255, 255, 255, 0.9)"}}}),e.jsxs(i,{sx:{display:"flex",gap:2,my:2},children:[e.jsx(A,{label:"Срок действия",value:x.expiry,onChange:v("expiry"),InputProps:{startAdornment:e.jsx(N,{position:"start",children:e.jsx(Ze,{sx:{color:"#4ECDC4"}})})},placeholder:"MM/YY",inputProps:{maxLength:5},sx:{flex:1,"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"rgba(78, 205, 196, 0.3)"},"&:hover fieldset":{borderColor:"rgba(78, 205, 196, 0.5)"},"&.Mui-focused fieldset":{borderColor:"#4ECDC4"}},"& .MuiInputLabel-root":{color:"rgba(255, 255, 255, 0.7)"},"& .MuiOutlinedInput-input":{color:"rgba(255, 255, 255, 0.9)"}}}),e.jsx(A,{label:"CVV",value:x.cvv,onChange:v("cvv"),InputProps:{startAdornment:e.jsx(N,{position:"start",children:e.jsx(ue,{sx:{color:"#4ECDC4"}})})},type:"password",inputProps:{maxLength:3},sx:{width:"120px","& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"rgba(78, 205, 196, 0.3)"},"&:hover fieldset":{borderColor:"rgba(78, 205, 196, 0.5)"},"&.Mui-focused fieldset":{borderColor:"#4ECDC4"}},"& .MuiInputLabel-root":{color:"rgba(255, 255, 255, 0.7)"},"& .MuiOutlinedInput-input":{color:"rgba(255, 255, 255, 0.9)"}}})]}),e.jsx(A,{fullWidth:!0,label:"Имя владельца",value:x.name,onChange:v("name"),margin:"normal",placeholder:"Capy Bara",InputProps:{startAdornment:e.jsx(N,{position:"start",children:e.jsx(ee,{sx:{color:"#4ECDC4"}})})},sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"rgba(78, 205, 196, 0.3)"},"&:hover fieldset":{borderColor:"rgba(78, 205, 196, 0.5)"},"&.Mui-focused fieldset":{borderColor:"#4ECDC4"}},"& .MuiInputLabel-root":{color:"rgba(255, 255, 255, 0.7)"},"& .MuiOutlinedInput-input":{color:"rgba(255, 255, 255, 0.9)"}}}),c&&e.jsx(xe,{in:!0,children:e.jsx(qe,{severity:$?"info":"error",sx:{my:2,bgcolor:$?"rgba(78, 205, 196, 0.1)":"rgba(255, 107, 107, 0.1)",color:$?"#4ECDC4":"#FF6B6B",border:`1px solid ${$?"#4ECDC4":"#FF6B6B"}`,"& .MuiAlert-icon":{color:$?"#4ECDC4":"#FF6B6B"}},children:c})}),e.jsxs(i,{sx:{display:"flex",gap:2,mt:4},children:[e.jsx(L,{variant:"outlined",onClick:d,fullWidth:!0,sx:{borderColor:"#4ECDC4",color:"#4ECDC4","&:hover":{borderColor:"#3dbdb5",bgcolor:"rgba(77, 205, 196, 0.1)"}},children:"Отмена"}),e.jsx(L,{type:"submit",variant:"contained",fullWidth:!0,disabled:H,sx:{bgcolor:"#4ECDC4",color:"#1a1a1a",fontWeight:"bold","&:hover":{bgcolor:"#3dbdb5"},"&:disabled":{bgcolor:"rgba(78, 205, 196, 0.3)",color:"rgba(255, 255, 255, 0.3)"}},children:H?"Обработка...":"Оплатить"})]})]}),e.jsxs(a,{variant:"body2",sx:{mt:3,textAlign:"center",color:"rgba(255,255,255,0.6)",display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:[e.jsx(ue,{sx:{fontSize:"1rem",color:"#4ECDC4"}}),"Безопасная оплата через КапиБанк"]})]})})})}const jr=[{title:"Лунный календарь «Циклы света»",description:"Планируйте дела по фазам Луны и Солнца в удобном PDF. Получите доступ к древней астрологической мудрости в современном формате для гармоничной жизни в потоке космических энергий.",image:"/static/service1.png",price:"1 астролапка",features:["Ежедневные астрологические рекомендации","Инфографика‑календарь с указанием фаз луны","Советы по ритуалам в каждой фазе"]},{title:"Премиум‑карта «Звёздный навигатор»",description:"Полный астрологический анализ на год вперёд с дополнительными опциями для максимального погружения. Раскройте потенциал своей судьбы с помощью древних знаний.",image:"/static/service2.png",price:"5 астролапок",features:["Натальная карта + транзиты планет","Углублённый отчёт в подарочном буклете","Видеоразбор от астролога-эксперта"]},{title:"Экспедиция «Врата Созвездий»",description:"Личный астролог отправится в древнее место силы в предгорьях Капибаревской Сопки, где проведёт многодневный ритуал очищения вашей кармы в период максимальной активности вашего зодиакального созвездия.",image:"/static/service3.png",price:"25 астролапок",features:["4 дня ритуалов в местах пересечения лей-линий звёздных энергий Капибаревской Сопки","Создание персонального оберега из горного хрусталя в час силы*"],footnote:"*Доставка оберега оплачивается отдельно"}],yr=[{name:"Елена Звездова",title:"Мастер натальных карт",image:"/static/astrologer1.jpg",sign:"Овен",experience:15,specialization:"Ведические практики, натальные карты, прогрессии",description:"С детства одаренная необычным видением мира, Елена посвятила 15 лет изучению ведической астрологии в Непале и Тибете. Её прогнозы поражают точностью и глубиной, а методики работы с кармическими узлами признаны уникальными даже среди опытных астрологов.",achievements:["Автор методики «Кармические Ключи»","Создатель собственной школы астрологии","Личный астролог известных деятелей искусства"],availability:8},{name:"Михаил Лунев",title:"Астролог-прогностик",image:"/static/astrologer2.jpg",sign:"Скорпион",experience:12,specialization:"Хорарная астрология, прогнозирование, финансовые циклы",description:"Михаил соединяет классические техники астрологии с передовыми методами анализа данных. Специализируется на точных прогнозах и выборе благоприятного времени для важных решений. Его консультации особенно ценят бизнесмены и те, кто стоит перед важным жизненным выбором.",achievements:["Разработчик системы «Астро-финанс»","Преподаватель в Академии Астрологических Наук","Автор книги «Время Успеха»"],availability:4},{name:"Анастасия Звездоцвет",title:"Астропсихолог",image:"/static/astrologer3.jpg",sign:"Рыбы",experience:9,specialization:"Психологическая астрология, детские гороскопы, совместимость",description:"Анастасия обладает уникальным даром соединять астрологические знания с глубоким пониманием психологии человека. Её подход помогает не только понять причины происходящего, но и найти путь к гармонии. Специализируется на семейных отношениях и детских гороскопах.",achievements:["Создатель методики «Астро-Гармония»","Ведущая астрологического подкаста","Эксперт по детской астропсихологии"],availability:6}],Cr=["Первая услуга бесплатно!","Личный астролог подберёт благоприятные даты","Дипломированные астрологи с многолетним опытом","Сакральные знания древней астрологии","Все услуги в гармонии с движением планет"],Sr="/api";function wr({onStartConsultation:g,credits:d,hasUsedFreeCredit:m,onCreditsUpdate:x,totalAvailableHours:n,userInfo:c}){const[h,H]=s.useState(null),[R,$]=s.useState(0),[w,v]=s.useState(!1),[j,b]=s.useState(null),[O,_]=s.useState(!1),[W,E]=s.useState(!1),[C,K]=s.useState(n);s.useEffect(()=>{if(c!=null&&c.email)if(n!==null){K(n);const o=setTimeout(()=>{E(!0)},2e3);return()=>clearTimeout(o)}else(async()=>{try{const u=await fetch(`${Sr}/astrologers`,{credentials:"include"});if(u.ok){const M=await u.json();if(M.success&&M.astrologers){const D=M.astrologers.reduce((y,q)=>{const ae=q.availableHours-q.bookedHours;return y+Math.max(0,ae)},0);K(D),setTimeout(()=>{E(!0)},2e3)}}}catch(u){console.error("Error fetching astrologers:",u)}})();else E(!1)},[n,c]);const B=()=>{const o=R+1;$(o),o===7&&_(!0)},U=(o,u)=>{u!=="clickaway"&&_(!1)},k=o=>{b(o),v(!0)},te=()=>{j&&x&&x(d+j.amount),v(!1),b(null)},re=()=>{v(!1),b(null)},oe=o=>o===0?"часов":o===1?"час":o>1&&o<5?"часа":"часов";return w?e.jsx(vr,{selectedPackage:j,onSuccess:te,onCancel:re}):e.jsxs(i,{sx:{bgcolor:"#1a1a1a",minHeight:"100vh",color:"white",position:"relative"},children:[e.jsx(Ct,{open:O,autoHideDuration:6e3,onClose:U,anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(qe,{onClose:U,severity:"success",variant:"filled",sx:{width:"100%",bgcolor:"#4ECDC4","& .MuiAlert-icon":{color:"white"},"& .MuiAlert-message":{color:"white",fontSize:"1.1rem"}},children:e.jsxs(i,{sx:{textAlign:"center"},children:[e.jsx(a,{variant:"h6",component:"div",sx:{mb:1},children:"🌟 Поздравляем! Вы нашли секретную капибару! 🌟"}),e.jsx(a,{children:"Вам будет доступен бесплатный астрологический прогноз при первом обращении к нашим мастерам!"})]})})}),e.jsx(xe,{in:W&&(c==null?void 0:c.email),timeout:800,children:e.jsx(i,{sx:{position:"fixed",bottom:30,left:30,zIndex:1e3,maxWidth:360,animation:C===0?"pulse 1.5s infinite":"none","@keyframes pulse":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(1.05)"},"100%":{transform:"scale(1)"}},cursor:"pointer"},onClick:g,children:e.jsx(I,{elevation:8,sx:{borderRadius:2,overflow:"hidden",background:"linear-gradient(45deg, #FF6B6B, #4ECDC4)",boxShadow:"0 4px 20px rgba(0,0,0,0.25)",transition:"all 0.3s ease","&:hover":{transform:"translateY(-5px)",boxShadow:"0 8px 30px rgba(0,0,0,0.3)",background:"linear-gradient(45deg, #FF6B6B, #4ECDC4)",backgroundSize:"200% 200%",animation:"gradientShift 2s ease infinite"},"@keyframes gradientShift":{"0%":{backgroundPosition:"0% 50%"},"50%":{backgroundPosition:"100% 50%"},"100%":{backgroundPosition:"0% 50%"}}},children:e.jsxs(i,{sx:{p:2.5,display:"flex",alignItems:"center",gap:2},children:[e.jsx(Ce,{sx:{fontSize:36,color:"white",animation:C===0?"spin 3s linear infinite":"pulse 2s ease-in-out infinite","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}},"@keyframes pulse":{"0%":{opacity:.7},"50%":{opacity:1},"100%":{opacity:.7}}}}),e.jsxs(i,{children:[e.jsx(a,{variant:"h6",sx:{fontWeight:"bold",color:"white",textShadow:"0 1px 2px rgba(0,0,0,0.2)",lineHeight:1.2},children:C===0?"Консультации закончились!":`Осталось всего ${C} ${oe(C)} доступных для бронирования!`}),e.jsx(a,{variant:"body2",sx:{color:"rgba(255,255,255,0.9)",mt:.5},children:C===0?"Запишитесь в лист ожидания сейчас":"Успейте забронировать встречу с астрологом"})]})]})})})}),e.jsxs(i,{sx:{background:"linear-gradient(45deg, #FF6B6B, #4ECDC4)",py:2,px:4,display:"flex",justifyContent:"center",alignItems:"center",gap:2},children:[e.jsx(Ke,{}),e.jsx(a,{variant:"h6",sx:{fontWeight:500},children:m?`У вас ${d} астролапка(ок) для консультаций`:"Первая консультация бесплатно! Начните свой духовный путь прямо сейчас"})]}),e.jsx(i,{sx:{background:"linear-gradient(135deg, #2a0845 0%, #6441A5 100%)",color:"white",height:"calc(100vh - 56px)",display:"flex",alignItems:"center",position:"relative",overflow:"hidden",textAlign:"center"},children:e.jsxs(F,{maxWidth:"lg",children:[e.jsx(a,{variant:"h1",component:"h1",gutterBottom:!0,sx:{fontSize:{xs:"2.5rem",md:"4rem"},fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.3)",mb:4},children:"Астрология и древние практики"}),e.jsx(a,{variant:"h5",sx:{mb:6,opacity:.9,maxWidth:"800px",margin:"0 auto",lineHeight:1.5},children:"Откройте врата в мир древних знаний с опытными астрологами. Доверьтесь мудрости веков для преображения вашей судьбы."}),e.jsx(L,{variant:"contained",size:"large",onClick:g,sx:{bgcolor:"rgba(255,255,255,0.9)",color:"#2a0845",fontSize:"1.2rem",py:2,px:6,mt:4,borderRadius:"50px",boxShadow:"0 4px 20px rgba(0,0,0,0.15)",position:"relative",zIndex:2,"&:hover":{bgcolor:"white",transform:"scale(1.05) translateY(-2px)",transition:"all 0.3s ease",boxShadow:"0 6px 25px rgba(0,0,0,0.2)"}},children:"Начать свой путь"}),e.jsx(T,{title:"Погладь капибару на удачу!",placement:"top",children:e.jsx(ee,{sx:{position:"absolute",bottom:20,right:20,fontSize:"2rem",cursor:"pointer",opacity:.7,"&:hover":{opacity:1,transform:"rotate(360deg)",transition:"all 0.5s ease"}},onClick:B})}),e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:2,mt:4,bgcolor:"rgba(255,255,255,0.1)",borderRadius:3,p:2,maxWidth:"fit-content",margin:"2rem auto"},children:[e.jsx(St,{badgeContent:d,color:"primary",children:e.jsx(ve,{sx:{fontSize:"2rem"}})}),e.jsx(a,{children:m?`У вас осталось ${d} астролапка(ок)`:"У вас есть бесплатная астролапка для первой консультации!"})]})]})}),e.jsxs(F,{sx:{py:12},children:[e.jsx(a,{variant:"h2",component:"h2",textAlign:"center",gutterBottom:!0,sx:{mb:8,position:"relative","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(45deg, #FF6B6B, #4ECDC4)",backgroundClip:"text",WebkitBackgroundClip:"text",color:"transparent",display:"block",fontWeight:"bold",fontSize:{xs:"2rem",md:"3rem"},textAlign:"center",letterSpacing:"0.02em",WebkitTextFillColor:"transparent"}},children:"Наши услуги"}),e.jsx(S,{container:!0,spacing:6,children:jr.map((o,u)=>e.jsx(S,{item:!0,xs:12,md:4,sx:{display:"flex","& > *":{flex:1}},children:e.jsxs(Ae,{sx:{height:"100%",display:"flex",flexDirection:"column",bgcolor:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)",position:"relative",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",borderRadius:2,transition:"all 0.3s ease","&:hover":{transform:"scale(1.05)",bgcolor:"rgba(255,255,255,0.05)"}},children:[e.jsxs(i,{sx:{position:"relative"},children:[e.jsx(Le,{component:"img",height:"300",image:o.image,alt:o.title,sx:{filter:"brightness(0.8)",objectFit:"cover",width:"100%",height:"300px",borderRadius:"8px 8px 0 0"}}),e.jsx(i,{sx:{position:"absolute",bottom:0,left:0,right:0,height:"100%",background:"linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0) 50%)",borderRadius:"8px 8px 0 0"}})]}),e.jsxs(He,{sx:{color:"white",flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[e.jsxs(i,{children:[e.jsx(a,{variant:"h5",component:"h3",gutterBottom:!0,sx:{color:"#4ECDC4",fontSize:"1.5rem"},children:o.title}),e.jsx(a,{variant:"body1",sx:{mb:2,color:"rgba(255,255,255,0.8)",fontSize:"1.1rem",lineHeight:1.5},children:o.description}),e.jsx(Q,{sx:{mb:2,pl:0},children:o.features&&o.features.map((M,D)=>e.jsxs(G,{sx:{py:.5,px:0},children:[e.jsx(ie,{sx:{minWidth:"30px"},children:e.jsx(Z,{fontSize:"small",sx:{color:"#FF6B6B"}})}),e.jsx(V,{primary:M,sx:{"& .MuiTypography-root":{fontSize:"1rem",color:"rgba(255,255,255,0.9)",lineHeight:1.4}}})]},D))}),o.footnote&&e.jsx(a,{variant:"caption",sx:{display:"block",mt:1,fontStyle:"italic",color:"rgba(255,255,255,0.6)",fontSize:"0.75rem"},children:o.footnote})]}),e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:2,mt:"auto"},children:[e.jsx(a,{variant:"h6",sx:{color:"#FF6B6B",textDecoration:u===0?"line-through":"none",opacity:u===0?.7:1},children:o.price}),u===0?e.jsx(a,{variant:"h6",sx:{color:"#4ECDC4",fontWeight:"bold"},children:"БЕСПЛАТНО!"}):null]})]})]})},u))}),e.jsxs(I,{sx:{mt:8,p:4,bgcolor:"rgba(255,255,255,0.05)",borderRadius:4,backdropFilter:"blur(10px)",textAlign:"center"},children:[e.jsx(a,{variant:"h4",gutterBottom:!0,sx:{color:"#4ECDC4"},children:"Приобретите астролапки для оплаты услуг"}),e.jsx(a,{sx:{color:"rgba(255,255,255,0.8)",mb:3},children:"Инвестируйте в свою судьбу с помощью опытных астрологов и древних практик"}),e.jsx(S,{container:!0,spacing:3,justifyContent:"center",children:[{amount:1,price:"5000₡",discount:"Пробный пакет"},{amount:5,price:"20000₡",discount:"15% выгода"},{amount:25,price:"75000₡",discount:"40% выгода"}].map((o,u)=>e.jsx(S,{item:!0,xs:12,sm:4,sx:{display:"flex"},children:e.jsxs(I,{sx:{p:3,bgcolor:"rgba(255,255,255,0.03)",transition:"all 0.3s ease",display:"flex",flexDirection:"column",width:"100%",height:"100%","&:hover":{transform:"scale(1.05)",bgcolor:"rgba(255,255,255,0.05)"}},children:[e.jsxs(i,{sx:{flex:1},children:[e.jsxs(a,{variant:"h5",sx:{color:"#4ECDC4",mb:1},children:[o.amount," ",o.amount>=5?"Астролапок":"Астролапки"]}),e.jsx(a,{variant:"h6",sx:{color:"#FF6B6B"},children:o.price}),e.jsxs(a,{variant:"body2",sx:{color:"rgba(255,255,255,0.6)"},children:["Скидка ",o.discount]})]}),e.jsx(L,{variant:"contained",fullWidth:!0,onClick:()=>k(o),sx:{mt:2,bgcolor:"#4ECDC4","&:hover":{bgcolor:"#3dbdb5"}},children:"Купить"})]})},u))})]})]}),e.jsx(i,{sx:{bgcolor:"rgba(255,255,255,0.02)",py:12},children:e.jsxs(F,{children:[e.jsx(a,{variant:"h3",component:"h2",textAlign:"center",gutterBottom:!0,sx:{mb:8,background:"linear-gradient(45deg, #4ECDC4, #FF6B6B)",backgroundClip:"text",WebkitBackgroundClip:"text",color:"transparent"},children:"Почему мы?"}),e.jsxs(S,{container:!0,spacing:6,children:[e.jsx(S,{item:!0,xs:12,md:6,children:e.jsx(Q,{children:Cr.map((o,u)=>e.jsxs(G,{sx:{mb:2,bgcolor:"rgba(255,255,255,0.03)",borderRadius:2,transition:"all 0.3s ease","&:hover":{bgcolor:"rgba(255,255,255,0.05)",transform:"translateX(10px)"}},children:[e.jsx(ie,{children:e.jsx(Z,{sx:{color:"#4ECDC4"}})}),e.jsx(V,{primary:o,sx:{"& .MuiTypography-root":{color:"rgba(255,255,255,0.9)"}}})]},u))})}),e.jsx(S,{item:!0,xs:12,md:6,children:e.jsxs(i,{sx:{p:4,bgcolor:"rgba(255,255,255,0.03)",borderRadius:4,backdropFilter:"blur(10px)"},children:[e.jsx(a,{variant:"h5",gutterBottom:!0,sx:{color:"#4ECDC4"},children:"Начните сегодня"}),e.jsx(a,{paragraph:!0,sx:{color:"rgba(255,255,255,0.8)"},children:"Наши опытные астрологи готовы применить древние знания, чтобы открыть для вас новые пути и возможности в потоке космических энергий."}),e.jsx(L,{variant:"contained",size:"large",onClick:g,sx:{bgcolor:"#4ECDC4","&:hover":{bgcolor:"#3dbdb5"}},children:"Записаться к астрологу"})]})})]})]})}),e.jsx(F,{sx:{py:12},children:e.jsx(S,{container:!0,spacing:6,children:[{icon:e.jsx(Ne,{sx:{fontSize:60,color:"#4ECDC4"}}),title:"Опытные астрологи",description:"Наши мастера совмещают классическую астрологию с древними практиками."},{icon:e.jsx(Ye,{sx:{fontSize:60,color:"#4ECDC4"}}),title:"Астрологическое время",description:"Все услуги проводятся в моменты максимальной силы планет."},{icon:e.jsx(Ge,{sx:{fontSize:60,color:"#4ECDC4"}}),title:"Индивидуальный подход",description:"Каждая услуга основана на вашей личной натальной карте."}].map((o,u)=>e.jsx(S,{item:!0,xs:12,md:4,sx:{display:"flex","& > *":{flex:1}},children:e.jsxs(i,{sx:{textAlign:"center",p:3,bgcolor:"rgba(255,255,255,0.03)",borderRadius:4,transition:"all 0.3s ease",display:"flex",flexDirection:"column",alignItems:"center",height:"100%","&:hover":{transform:"translateY(-10px)",bgcolor:"rgba(255,255,255,0.05)"}},children:[e.jsx(i,{sx:{display:"flex",justifyContent:"center",width:"100%"},children:o.icon}),e.jsx(a,{variant:"h6",gutterBottom:!0,sx:{color:"#4ECDC4",mt:2},children:o.title}),e.jsx(a,{sx:{color:"rgba(255,255,255,0.8)",flex:1},children:o.description})]})},u))})}),e.jsx(i,{sx:{bgcolor:"rgba(255,255,255,0.01)",py:12},children:e.jsxs(F,{children:[e.jsx(a,{variant:"h2",component:"h2",textAlign:"center",gutterBottom:!0,sx:{mb:8,position:"relative","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(45deg, #4ECDC4, #FF6B6B)",backgroundClip:"text",WebkitBackgroundClip:"text",color:"transparent",display:"block",fontWeight:"bold",fontSize:{xs:"2rem",md:"3rem"},textAlign:"center",letterSpacing:"0.02em",WebkitTextFillColor:"transparent"}},children:"Наши астрологи"}),e.jsx(a,{variant:"h6",textAlign:"center",sx:{mb:6,color:"rgba(255,255,255,0.8)",maxWidth:"800px",mx:"auto"},children:"Познакомьтесь с нашими опытными астрологами, которые помогут вам раскрыть тайны вашей судьбы и направят на путь гармонии и процветания"}),e.jsx(S,{container:!0,spacing:6,children:yr.map((o,u)=>e.jsx(S,{item:!0,xs:12,md:4,sx:{display:"flex",height:"100%"},children:e.jsxs(Ae,{sx:{display:"flex",flexDirection:"column",bgcolor:"rgba(255,255,255,0.03)",backdropFilter:"blur(10px)",borderRadius:4,overflow:"hidden",transition:"all 0.3s ease",height:"100%",width:"100%","&:hover":{transform:"translateY(-10px)",boxShadow:"0 12px 30px rgba(78, 205, 196, 0.2)","& .MuiCardMedia-root":{transform:"scale(1.05)"}}},children:[e.jsxs(i,{sx:{position:"relative",overflow:"hidden"},children:[e.jsx(Le,{component:"img",height:"300",image:o.image,alt:o.name,sx:{transition:"transform 0.5s ease",objectFit:"cover"}}),e.jsx(i,{sx:{position:"absolute",bottom:0,left:0,right:0,height:"50%",background:"linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0) 100%)"}}),e.jsxs(i,{sx:{position:"absolute",bottom:0,left:0,width:"100%",p:2,zIndex:2},children:[e.jsx(a,{variant:"h5",component:"h3",sx:{color:"white",fontWeight:"bold",textShadow:"0 2px 4px rgba(0,0,0,0.5)"},children:o.name}),e.jsx(a,{variant:"subtitle1",sx:{color:"#4ECDC4",textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:o.title})]}),e.jsx(ne,{label:`${o.availability} часов доступно`,sx:{position:"absolute",top:16,right:16,bgcolor:o.availability>0?"rgba(78, 205, 196, 0.9)":"rgba(255, 107, 107, 0.9)",color:"white",fontWeight:"bold",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"}})]}),e.jsxs(He,{sx:{p:3,flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsxs(i,{sx:{mb:2,display:"flex",gap:1,flexWrap:"wrap"},children:[e.jsx(ne,{icon:e.jsx(Je,{fontSize:"small"}),label:`Знак: ${o.sign}`,size:"small",sx:{bgcolor:"rgba(255,255,255,0.05)",color:"#FF6B6B"}}),e.jsx(ne,{icon:e.jsx(Ue,{fontSize:"small"}),label:`Опыт: ${o.experience} лет`,size:"small",sx:{bgcolor:"rgba(255,255,255,0.05)",color:"#4ECDC4"}})]}),e.jsx(a,{variant:"subtitle2",sx:{color:"#4ECDC4",mb:1},children:"Специализация:"}),e.jsx(a,{variant:"body2",sx:{color:"rgba(255,255,255,0.8)",mb:2},children:o.specialization}),e.jsx(a,{variant:"body2",sx:{color:"rgba(255,255,255,0.8)",mb:2,flex:1},children:o.description}),e.jsx(wt,{sx:{my:2,bgcolor:"rgba(255,255,255,0.1)"}}),e.jsxs(i,{children:[e.jsxs(a,{variant:"subtitle2",sx:{color:"#4ECDC4",mb:1,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Xe,{fontSize:"small"})," Достижения:"]}),e.jsx(Q,{dense:!0,disablePadding:!0,children:o.achievements.map((M,D)=>e.jsxs(G,{sx:{py:.5,px:0},children:[e.jsx(ie,{sx:{minWidth:"30px"},children:e.jsx(Z,{fontSize:"small",sx:{color:"#FF6B6B"}})}),e.jsx(V,{primary:M,sx:{"& .MuiTypography-root":{fontSize:"0.875rem",color:"rgba(255,255,255,0.8)"}}})]},D))})]}),e.jsx(L,{variant:"contained",fullWidth:!0,onClick:g,sx:{mt:3,background:"linear-gradient(45deg, #4ECDC4, #FF6B6B)",color:"white","&:hover":{background:"linear-gradient(45deg, #3dbdb5, #ff5b5b)",transform:"translateY(-2px)"}},children:"Запись на консультацию"})]})]})},u))})]})})]})}var De={},_r=p;Object.defineProperty(De,"__esModule",{value:!0});var tt=De.default=void 0,kr=_r(f()),Mr=e;tt=De.default=(0,kr.default)((0,Mr.jsx)("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home");var Ie={},$r=p;Object.defineProperty(Ie,"__esModule",{value:!0});var rt=Ie.default=void 0,Er=$r(f()),Ve=e;rt=Ie.default=(0,Er.default)([(0,Ve.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),(0,Ve.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"AccessTime");const ce=[{text:"Читает карту небесных тел",emoji:"🌚"},{text:"Разгадывает послания небес",emoji:"✨"},{text:"Советуется с планетами",emoji:"🌍"},{text:"Сверяется с гороскопом",emoji:"🔮"},{text:"Вслушивается в эхо глубин",emoji:"🌊"}],Dr=`
  @keyframes loadingDots {
    0% { content: '.'; }
    33% { content: '..'; }
    66% { content: '...'; }
    100% { content: '.'; }
  }
  .loading-dots::after {
    content: '.';
    animation: loadingDots 1.5s infinite;
    display: inline-block;
    width: 24px;
    text-align: left;
  }
  @keyframes fadeInOut {
    0% { opacity: 0; }
    20% { opacity: 1; }
    80% { opacity: 1; }
    100% { opacity: 0; }
  }
  .loading-message {
    animation: fadeInOut 3s ease-in-out;
  }
`,Ir=_t({palette:{mode:"dark",primary:{main:"#4ECDC4"},background:{default:"#1a1a1a",paper:"#2a2a2a"}},typography:{fontFamily:'"Roboto", "Arial", sans-serif'},components:{MuiButton:{styleOverrides:{root:{borderRadius:"50px",textTransform:"none"}}}}}),z="/api";function Rr(){const[g,d]=s.useState([]),[m,x]=s.useState(""),[n,c]=s.useState(!1),[h,H]=s.useState(!1),[R,$]=s.useState(0),[w,v]=s.useState(!1),[j,b]=s.useState(""),[O,_]=s.useState(0),[W,E]=s.useState(0),[C,K]=s.useState([]),[B,U]=s.useState([]),[k,te]=s.useState(null),[re,oe]=s.useState(""),[o,u]=s.useState(null),[M,D]=s.useState(null),[y,q]=s.useState(null),[ae,Re]=s.useState(!1),Be=s.useRef(null),[ot,at]=s.useState(0),st=()=>{var t;(t=Be.current)==null||t.scrollIntoView({behavior:"smooth"})},se=()=>{at(t=>t+1)};s.useEffect(()=>{w&&!n&&se()},[w,n]),s.useEffect(()=>{st()},[g]),s.useEffect(()=>{h&&(console.log("Initial session check on chat open"),ut(),lt())},[h]),s.useEffect(()=>{h&&nt()},[h]),s.useEffect(()=>{let t;return n&&(t=setInterval(()=>{_(r=>(r+1)%ce.length)},3e3)),()=>{t&&clearInterval(t)}},[n]),s.useEffect(()=>{if(B.length>0){const t=B.reduce((r,l)=>{const P=l.availableHours-l.bookedHours;return r+P},0);te(t),t===0&&!re&&it()}},[B]),s.useEffect(()=>{h&&Pe()},[h]);const it=async()=>{try{const t=await fetch(`${z}/flag`,{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch flag");const r=await t.json();r.success&&r.flag&&(oe(r.flag),d(l=>[...l,{text:r.flag,sender:"bot",special:!0}]))}catch(t){console.error("Error fetching flag:",t)}},nt=async()=>{try{console.log("Loading chat history...");const t=await fetch(`${z}/chat/history`,{credentials:"include"});if(!t.ok)throw new Error("Network response was not ok");const r=await t.json();r.success&&r.history&&r.history.length>0?(console.log("Chat history loaded:",r.history.length,"messages"),d(r.history)):console.log("No chat history found or empty history")}catch(t){console.error("Error loading chat history:",t)}},lt=async()=>{try{const t=await fetch(`${z}/user/balance`,{credentials:"include"});if(!t.ok)throw new Error("Network response was not ok");const r=await t.json();r.success&&E(r.balance)}catch(t){console.error("Error loading user balance:",t)}},ct=async()=>{try{const t=await fetch(`${z}/bookings`,{credentials:"include"});if(!t.ok)throw new Error("Network response was not ok");const r=await t.json();r.success&&K(r.bookings||[])}catch(t){console.error("Error loading user bookings:",t)}},Pe=async()=>{try{const t=await fetch(`${z}/astrologers`,{credentials:"include"});if(!t.ok)throw new Error("Network response was not ok");const r=await t.json();r.success&&U(r.astrologers||[])}catch(t){console.error("Error loading astrologers:",t)}},dt=()=>{$(t=>{const r=t+1;return r===5&&d(l=>[...l,{text:"🌟 Капибара шепчет: 'Запишитесь на консультацию и узнайте все о своей судьбе!' 🌟",sender:"bot",special:!0}]),r})},ut=async()=>{try{console.log("Checking session status...");const t=await fetch(`${z}/session/status`,{credentials:"include"});if(!t.ok)throw new Error("Network response was not ok");const r=await t.json();return v(r.ready),r.userInfo&&q(r.userInfo),r.message&&r.message!==j&&(b(r.message),(g.length===0||r.message!==j&&!g.some(l=>l.sender==="bot"&&l.text===r.message))&&d(l=>[...l,{text:r.message,sender:"bot",special:r.message.includes("tctf{")}])),r.ready&&se(),r}catch(t){return console.error("Error checking session status:",t),j!=="Ошибка при проверке статуса сессии"&&(b("Ошибка при проверке статуса сессии"),(g.length===0||!g.some(r=>r.text==="Ошибка при проверке статуса сессии"))&&d(r=>[...r,{text:"Ошибка при проверке статуса сессии",sender:"bot",special:!1}])),null}},ze=async t=>{if(t.trim()){x(""),d(r=>[...r,{text:t,sender:"user"}]),c(!0);try{const r=await fetch(`${z}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({message:t})});if(r.status===429){d(P=>[...P,{text:"Пожалуйста, не отправляйте сообщения слишком быстро. Подождите секунду и попробуйте снова.",sender:"bot",special:!1}]);return}if(!r.ok)throw new Error(`Network response was not ok: ${r.status}`);const l=await r.json();l.success?(d(P=>[...P,{text:l.message,sender:"bot",special:l.message.includes("tctf{")}]),l.sessionStatus&&(v(l.sessionStatus.ready),l.sessionStatus.userInfo&&q(l.sessionStatus.userInfo),!l.sessionStatus.ready&&l.message?b(l.message):l.sessionStatus.ready&&j&&b("")),l.balance!==void 0&&E(l.balance)):d(P=>[...P,{text:l.message||"Произошла ошибка при обработке сообщения",sender:"bot",special:(l.message||"").includes("tctf{")}])}catch(r){console.error("Error:",r),d(l=>[...l,{text:"Извините, произошла ошибка. Пожалуйста, попробуйте еще раз.",sender:"bot",special:!1}])}finally{c(!1),se()}}},Fe=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),ze(m))},xt=()=>{H(!0)},ht=t=>{ct(),u(t.currentTarget)},pt=()=>{u(null)},ft=t=>{Pe(),D(t.currentTarget)},gt=()=>{D(null)},mt=t=>{if(!t)return"";let r=t.replace(/\*\*(.*?)\*\*/g,"$1");return r=r.replace(/\n- /g,`
• `),r};s.useEffect(()=>{if(h&&(y!=null&&y.email)&&k!==null){const t=setTimeout(()=>{Re(!0)},2e3);return()=>clearTimeout(t)}else Re(!1)},[h,y==null?void 0:y.email,k]);const bt=t=>t===0?"часов":t===1?"час":t>1&&t<5?"часа":"часов";return e.jsxs(kt,{theme:Ir,children:[e.jsx("style",{children:Dr}),h?e.jsxs(i,{sx:{minHeight:"100vh",width:"100%",background:"linear-gradient(135deg, #2a0845 0%, #6441A5 100%)",padding:0,margin:0,display:"flex"},children:[e.jsx(xe,{in:ae&&(y==null?void 0:y.email),timeout:800,children:e.jsx(i,{sx:{position:"fixed",bottom:30,left:30,zIndex:1e3,maxWidth:320,animation:k===0?"pulse 1.5s infinite":"none","@keyframes pulse":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(1.05)"},"100%":{transform:"scale(1)"}},cursor:"pointer"},children:e.jsx(I,{elevation:8,sx:{borderRadius:2,overflow:"hidden",background:"linear-gradient(45deg, #FF6B6B, #4ECDC4)",boxShadow:"0 4px 20px rgba(0,0,0,0.25)",transition:"all 0.3s ease","&:hover":{transform:"translateY(-5px)",boxShadow:"0 8px 30px rgba(0,0,0,0.3)"}},children:e.jsxs(i,{sx:{p:2,display:"flex",alignItems:"center",gap:2},children:[e.jsx(Ce,{sx:{fontSize:32,color:"white",animation:k===0?"spin 3s linear infinite":"pulse 2s ease-in-out infinite","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}},"@keyframes pulse":{"0%":{opacity:.7},"50%":{opacity:1},"100%":{opacity:.7}}}}),e.jsx(i,{children:e.jsx(a,{variant:"body1",sx:{fontWeight:"bold",color:"white",textShadow:"0 1px 2px rgba(0,0,0,0.2)",lineHeight:1.2},children:k===0?"Консультации закончились!":`Осталось всего ${k} ${bt(k)} для бронирования!`})})]})})})}),e.jsx(F,{maxWidth:"md",sx:{height:"100vh",display:"flex",flexDirection:"column",py:4},children:e.jsxs(I,{elevation:3,sx:{flexGrow:1,display:"flex",flexDirection:"column",bgcolor:"background.paper",borderRadius:4,overflow:"hidden"},children:[e.jsxs(i,{sx:{p:2,borderBottom:1,borderColor:"divider",background:"linear-gradient(135deg, #2a0845 0%, #6441A5 100%)",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(a,{variant:"h5",sx:{fontWeight:500},children:"Ваша Духовная Консультация"}),e.jsx(i,{sx:{display:"flex",alignItems:"center",bgcolor:"rgba(255, 255, 255, 0.1)",px:1,py:0,borderRadius:2,gap:1},children:e.jsx(T,{title:"Баланс астролапок",children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(a,{variant:"body1",children:W}),e.jsx("img",{src:"/static/lapka.png",alt:"Астролапка",style:{width:32,height:32,objectFit:"contain",margin:0,padding:0}})]})})})]}),e.jsxs(i,{children:[e.jsx(T,{title:"Погладить капибару",children:e.jsx(J,{color:"inherit",onClick:dt,sx:{mr:1},children:e.jsx(ee,{})})}),e.jsx(T,{title:"Вернуться на главную",children:e.jsx(J,{color:"inherit",onClick:()=>H(!1),children:e.jsx(tt,{})})}),e.jsx(T,{title:"Мои бронирования",children:e.jsx(J,{color:"inherit",onClick:ht,children:e.jsx(ve,{})})}),e.jsx(T,{title:"Доступность астрологов",children:e.jsx(J,{color:"inherit",onClick:ft,children:e.jsx(rt,{})})})]})]}),e.jsxs(Oe,{anchorEl:o,open:!!o,onClose:pt,PaperProps:{sx:{mt:1.5,width:280,maxHeight:300,overflow:"auto"}},children:[e.jsx(a,{sx:{p:1.5,fontWeight:"bold"},children:"Мои бронирования"}),C.length===0?e.jsx(X,{disabled:!0,children:"У вас пока нет забронированных консультаций"}):C.map(t=>e.jsx(X,{sx:{whiteSpace:"normal"},children:e.jsx(V,{primary:`${t.serviceName}`,secondary:`Астролог: ${t.astrologerName}`})},`${t.serviceId}-${t.astrologerId}`))]}),e.jsxs(Oe,{anchorEl:M,open:!!M,onClose:gt,PaperProps:{sx:{mt:1.5,width:280,maxHeight:300,overflow:"auto"}},children:[e.jsx(a,{sx:{p:1.5,fontWeight:"bold"},children:"Доступность астрологов"}),B.length===0?e.jsx(X,{disabled:!0,children:"Информация загружается..."}):B.map(t=>e.jsx(X,{sx:{whiteSpace:"normal"},children:e.jsx(V,{primary:`${t.name}`,secondary:`Доступно: ${t.availableHours-t.bookedHours} из ${t.availableHours} часов`})},t.id))]}),e.jsx(i,{sx:{flexGrow:1,overflow:"auto",p:2,bgcolor:"background.default"},children:e.jsxs(Q,{children:[g.map((t,r)=>e.jsx(G,{sx:{justifyContent:t.sender==="user"?"flex-end":"flex-start",mb:1},children:e.jsx(I,{sx:{p:2,maxWidth:"70%",bgcolor:t.sender==="user"?"primary.main":"background.paper",color:t.sender==="user"?"white":"text.primary",borderRadius:t.sender==="user"?"20px 20px 5px 20px":"20px 20px 20px 5px",boxShadow:"0 3px 10px rgba(0,0,0,0.2)",...t.special&&{background:"linear-gradient(45deg, #FF6B6B, #4ECDC4)",color:"white"}},children:e.jsx(V,{primary:mt(t.text),sx:{"& .MuiTypography-root":{whiteSpace:"pre-wrap"}}})})},r)),n&&e.jsx(G,{children:e.jsx(I,{sx:{p:2,bgcolor:"background.paper",borderRadius:2,display:"flex",alignItems:"center",gap:1},children:e.jsx(i,{sx:{display:"flex",alignItems:"center",gap:1},children:e.jsxs(a,{className:"loading-dots",children:[ce[O].emoji," ",ce[O].text]})})})}),e.jsx("div",{ref:Be})]})}),e.jsxs(i,{sx:{p:2,borderTop:1,borderColor:"divider",bgcolor:"background.paper"},children:[n?e.jsx(A,{fullWidth:!0,multiline:!0,maxRows:4,value:m,onChange:t=>x(t.target.value),onKeyPress:Fe,placeholder:j||"Введите ваше сообщение...",variant:"outlined",disabled:!0,sx:{mr:1,"& .MuiOutlinedInput-root":{borderRadius:3}}}):e.jsx(A,{fullWidth:!0,multiline:!0,maxRows:4,value:m,onChange:t=>x(t.target.value),onKeyPress:Fe,placeholder:j||"Введите ваше сообщение...",variant:"outlined",disabled:!w,autoFocus:w,sx:{mr:1,"& .MuiOutlinedInput-root":{borderRadius:3}}},`input-field-${ot}`),e.jsx(L,{variant:"contained",onClick:()=>ze(m),disabled:n||!w,sx:{mt:1,float:"right",px:4,py:1},children:"Отправить"})]})]})})]}):e.jsx(wr,{onStartConsultation:xt,totalAvailableHours:k,userInfo:y})]})}de.createRoot(document.getElementById("root")).render(e.jsx(Mt.StrictMode,{children:e.jsx(Rr,{})}));
